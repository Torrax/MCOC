-
-- OpenComputers Storage Drawers Controller (Minecraft 1.10.2)
-- by nzHook ( http://youtube.com/user/nzhook )
-- 08 April 2017
-- Released under a Creative Commons SA license
--
-- If given an argument search attached storage (storageside) for items and if 
--   one match pull upto 64 items into the attached chest (chestside)
--   If multiple items lists the items, give slot number to pull from that
--   slot
--   If no arguments return all items in chest (chestside)
--
-- Future updates will be available at http://youtube.com/user/nzhook
--
local c = require("component")
local ct = c.transposer
local shell = require("shell")
local sides = require("sides")

-- CHANGE THESE BASED ON YOUR SETUP
local storageside = sides.down
local chestside = sides.up
-- END CONFIG

local args, opts = shell.parse(...)

if args[1] then
	local searchfor = args[1]

	local counted = 0
	if not tonumber(searchfor) then
		local i = 0
		for i =1, (ct.getInventorySize(storageside)) do
			local item = ct.getStackInSlot(storageside, i)
 
			if item then
				if string.find(item.name .. "^" .. item.label .. "^", searchfor) then
					print(i .. ": " .. item.name .. " - " .. item.label .. " (" .. item.size .. ")")
					counted = counted + 1 
					slot = i
				end
			end 
		end
	else
		slot = tonumber(searchfor)
		counted = 1
	end

	if counted == 1 then
		ct.transferItem(storageside, chestside, 64, slot)
	end
else  -- No arguments indicate send everything back
	for i = ct.getInventorySize(chestside), 1, -1 do
		ct.transferItem(chestside, storageside, 64, i)
	end
end
